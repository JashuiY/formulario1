<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HGZ 01 - Oaxaca</title> 
    <style>  
        body{
            font-family: 'Georgia', sans-serif;
        }
        .form-container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            font-family: 'Georgia', sans-serif;
        }
        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .form-group label {
            width: 150px;
            margin-right: 10px;
            margin-left: 20px;
        }
        .form-group input, .form-group select {
            flex: 1;
            padding: 8px;
            box-sizing: border-box;
        }
        .radio-group, .checkbox-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .form-group .checkbox-group {
            flex-direction: column;
        }
        .submit-btn {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        fieldset{
            width: 50%;
            display: inline-block;
            box-sizing: border-box;
            font-family: 'Georgia', sans-serif;
        }
        .field1{
            width: 48%;
            font-family: 'Georgia', sans-serif;
        }
        .field2{
            width: 100%;
        }
        .boton{
            font-family: 'Georgia', sans-serif;
            font-size: 20px;
            height:50px;
            width:100px;
        }
        div{
            padding: 5px;
        }
        input.checkbox {
            margin-top: 20px;
        }
        h4{
            margin-top: 50px;
        }
        .observador{
            margin-top: 20px;
            margin-left: 10px;
        }
        select[multiple] {
            height: 30px;
            vertical-align: top;
        }
        select[multiple]:focus,
        select[multiple]:active {
            height: auto;
        }
        input.radio{
            font-family: Calibri, sans-serif;
        }
        footer{
            font-family: Calibri, sans-serif;
        }
    </style> <!-- ESTILOS CSS -->
</head>
<body>
    <h2 align="center">Formulario de Observación</h2>
    <h5 align="center"><script type="text/javascript">var timestamp = new Date();document.write(timestamp.toLocaleString("es-mx"));</script></h5>
    <div class="form-container">
        <form id="dataForm">
            <div class="form-group">
                <label for="turno">Turno:</label>
                <select id="turno" name="turno" required> <!-- LISTA DESPEGABLE DE TURNOS  -->
                    <option style="display:none"></option>
                    <option value="Jornada Acumulada">Jornada Acumulada</option>
                    <option value="Matutino">Matutino</option>
                    <option value="Vespertino">Vespertino</option>
                    <option value="Nocturno">Nocturno</option>
                </select>
            </div>
            <div class="form-group">
                <label for="servicio">Servicio:</label>
                <select id="servicio" name="servicio" required> <!-- LISTA DESPEGABLE DE SERVICIOS -->
                    <option style="display:none"></option>
                    <option value="Alergia E Inmunologia">Alergia E Inmunología</option>
                    <option value="Angiologia">Angiología</option>
                    <option value="Atencion Medica Continua">Atención Medica Continua</option>
                    <option value="Biologia De La Reproduccion">Biología De La Reproducción</option>
                    <option value="Cardiologia">Cardiología</option>
                    <option value="Cardiologia Pediatrica">Cardiología Pediátrica</option>
                    <option value="Cirugia Cardiovascular">Cirugía Cardiovascular</option>
                    <option value="Cirugia Cardiovascular Pediatrica">Cirugía Cardiovascular Pediátrica</option>
                    <option value="Cirugia De Cabeza Y Cuello">Cirugía De Cabeza Y Cuello</option>
                    <option value="Cirugia De Colon Y Recto">Cirugía De Colon Y Recto</option>
                    <option value="Cirugia General">Cirugía General</option>
                    <option value="Cirugia Maxilofacial">Cirugía Maxilofacial</option>
                    <option value="Cirugia Maxilofacial Pediatrica">Cirugía Maxilofacial Pediátrica</option>
                    <option value="Cirugia Pediatrica">Cirugía Pediátrica</option>
                    <option value="Cirugia Plastica Y Reconstructiva">Cirugía Plástica Y Reconstructiva</option>
                    <option value="Cirugia Plastica Y Reconstructiva Pediatrica">Cirugía Plástica Y Reconstructiva Pediátrica</option>
                    <option value="Consulta Externa">Consulta Externa</option>
                    <option value="Cunero Patologico">Cunero Patológico</option>
                    <option value="Curacion De Heridas">Curación de Heridas</option>
                    <option value="Dermatologia">Dermatología</option>
                    <option value="Endocrinologia Y Nutricion">Endocrinología Y Nutrición</option>
                    <option value="Endocrinologia Y Nutricion Pediatrica">Endocrinología Y Nutrición Pediátrica</option>
                    <option value="Endoscopia">Endoscopia</option>
                    <option value="Estomatologia">Estomatología</option>
                    <option value="Gastroenterologia">Gastroenterología</option>
                    <option value="Gastroenterologia Pediatrica">Gastroenterología Pediátrica</option>
                    <option value="Ginecologia">Ginecología</option>
                    <option value="Ginecologia Y Obstetricia">Ginecología Y Obstetricia</option>
                    <option value="Hematologia">Hematología</option>
                    <option value="Hematologia Pediatrica">Hematología Pediátrica</option>
                    <option value="Hemodialisis">Hemodiálisis</option>
                    <option value="Hemodinamia">Hemodinamia</option>
                    <option value="Infectologia">Infectología</option>
                    <option value="Infectologia Pediatrica">Infectología Pediátrica</option>
                    <option value="Laboratorio">Laboratorio</option>
                    <option value="Medicina Familiar">Medicina Familiar</option>
                    <option value="Medicina Fisica Y Rehabilitacion">Medicina Física Y Rehabilitación</option>
                    <option value="Medicina Interna">Medicina Interna</option>
                    <option value="Medicina Nuclear">Medicina Nuclear</option>
                    <option value="Modulo De Atencion Respiratoria">Modulo De Atención Respiratoria</option>
                    <option value="Nefrologia">Nefrología</option>
                    <option value="Nefrologia Pediatrica">Nefrología Pediátrica</option>
                    <option value="Neumologia">Neumología</option>
                    <option value="Neumologia Pediatrica">Neumología Pediátrica</option>
                    <option value="Neurocirugia">Neurocirugía</option>
                    <option value="Neurocirugia Pediatrica">Neurocirugía Pediátrica</option>
                    <option value="Neurofisiologia">Neurofisiología</option>
                    <option value="Neurologia">Neurología</option>
                    <option value="Neurologia Pediatrica">Neurología Pediátrica</option>
                    <option value="Nutricion Y Dietetica">Nutrición Y Dietética</option>
                    <option value="Obstetricia">Obstetricia</option>
                    <option value="Oftalmologia">Oftalmología</option>
                    <option value="Oftalmologia Pediatrica">Oftalmología Pediátrica</option>
                    <option value="Oncologia Medica">Oncología Medica</option>
                    <option value="Oncologia Medica Pediatrica">Oncología Medica Pediátrica</option>
                    <option value="Oncologia Quirurgica">Oncología Quirúrgica</option>
                    <option value="Oncologia Quirurgica Pediatrica">Oncología Quirúrgica Pediátrica</option>
                    <option value="Ortopedia  Y Traumatologia">Ortopedia  Y Traumatología</option>
                    <option value="Ortopedia Y Traumatologia Pediatrica">Ortopedia Y Traumatología Pediátrica</option>
                    <option value="Otorrinolaringologia">Otorrinolaringología</option>
                    <option value="Otorrinolaringologia Pediatrica">Otorrinolaringología Pediátrica</option>
                    <option value="Pediatria Medica">Pediatría Medica</option>
                    <option value="Preveimss">Preveimss</option>
                    <option value="Proctologia">Proctología</option>
                    <option value="Psiquiatria">Psiquiatría</option>
                    <option value="Quemados">Quemados</option>
                    <option value="Quimioterapia">Quimioterapia</option>
                    <option value="Quirofano">Quirófano</option>
                    <option value="Radiodiagnostico">Radiodiagnóstico</option>
                    <option value="Radioterapia">Radioterapia</option>
                    <option value="Reumatologia">Reumatología</option>
                    <option value="Reumatologia Pediatrica">Reumatología Pediátrica</option>
                    <option value="Transplante Renal">Transplante Renal</option>
                    <option value="Transplante Renal Pediatrico">Transplante Renal Pediátrico</option>
                    <option value="U.C.I. Adultos">U.C.I. Adultos</option>
                    <option value="U.C.I. Neonatales">U.C.I. Neonatales</option>
                    <option value="U.C.I. Pediatrica">U.C.I. Pediátrica</option>
                    <option value="Ucc Unidad De Cuidados Coronarios">Ucc Unidad De Cuidados Coronarios</option>
                    <option value="Unidad De Transplante De Medula Osea">Unidad De Transplante De Medula Ósea</option>
                    <option value="Unidad Metabolica">Unidad Metabólica</option>
                    <option value="Urgencias">Urgencias</option>
                    <option value="Urologia">Urología</option>
                    <option value="Urologia Pediatrica">Urología Pediátrica</option>
                </select>
            </div>            
            
            <div class="form-group">
                <fieldset class="field2"> <!-- CUADRO CON OBSERVADOR  -->
                    <legend>OBSERVADOR</legend> 
                    <div>
                        <input class="observador" type="text" id="nombre" name="nombre" placeholder="Nombre" style="width:60%" required>
                        <input class="observador" type="number" id="matricula" name="matricula" placeholder="Matrícula" style="width:35%" required>
                    </div>
                </fieldset>
            </div>

            <h4 align="center">OPORTUNIDAD</h4>
            <div class="form-group">
                <label for="categoria">Categoría:</label>
                <select id ="categoria" name="categoria" required> <!-- LISTA DESPLEGABLE CON CATEGORIAS  -->
                    <option name="categoria" style="display:none"></option>
                    <option name="categoria" value="Asistente Medica">Asistente Médica</option>
                    <option name="categoria" value="Auxiliar Universal De Oficinas">Auxiliar Universal De Oficinas</option>
                    <option name="categoria" value="Camillero">Camillero</option>
                    <option name="categoria" value="Conservacion">Conservación</option>
                    <option name="categoria" value="Coord De Estadistica">Coordinación De Estadística</option>
                    <option name="categoria" value="Enfermera">Enfermera</option>
                    <option name="categoria" value="Estomatologo">Estomatólogo</option>
                    <option name="categoria" value="Estudiante">Estudiante</option>
                    <option name="categoria" value="Familiar">Familiar</option>
                    <option name="categoria" value="Fisioterapeuta">Fisioterapeuta</option>
                    <option name="categoria" value="Inhaloterapeuta">Inhaloterapeuta</option>
                    <option name="categoria" value="Intendencia">Intendencia</option>
                    <option name="categoria" value="Jefe De Grupo Estadistica">Jefe De Grupo Estadística</option>
                    <option name="categoria" value="Laboratorista">Laboratorista</option>
                    <option name="categoria" value="Medico">Medico</option>
                    <option name="categoria" value="Medico Interno">Medico Interno</option>
                    <option name="categoria" value="Medico Rehabilitador">Medico Rehabilitador</option>
                    <option name="categoria" value="Mensajero">Mensajero</option>
                    <option name="categoria" value="Nutricion">Nutrición</option>
                    <option name="categoria" value="Oficial De Estadistica">Oficial De Estadística</option>
                    <option name="categoria" value="Operador Vehiculo">Operador Vehículo</option>
                    <option name="categoria" value="Personal De Roperia">Personal De Ropería</option>
                    <option name="categoria" value="Ptdam">Ptdam</option>
                    <option name="categoria" value="Rayos X">Rayos X</option>
                    <option name="categoria" value="Residente">Residente</option>
                    <option name="categoria" value="Terapista Ocupacional">Terapista Ocupacional</option>
                    <option name="categoria" value="Trabajador Social">Trabajador Social</option>
                </select>
            </div>
            
            <fieldset id="field1" class="field1"> <!-- CUADRO CON INDICACIONES -->
                <legend>Indicación:</legend>
                <div><input type="radio" name="indicacion" value="ant pac" /> Ant. pac.</label></div>
                <div><input type="radio" name="indicacion" value="ant asept" /> Ant. asept.</label></div>
                <div><input type="radio" name="indicacion" value="desp ent pac" /> Desp. ent. p.</label></div>
                <div><input type="radio" name="indicacion" value="desp pac" /> Desp. pac.</label></div>
                <div><input type="radio" name="indicacion" value="desp secre" /> Desp. fc.</label></div>
            </fieldset>
            <fieldset id="field2" class="field1"> <!-- CUADRO CON ACCIONES -->
                <legend>Acción de HM:</legend>
                <div><input type="radio" name="accion" value="FM" id="fm" required /> FM</label></div>
                <div><input type="radio" name="accion" value="LM" id="lm" /> LM</label></div>
                <div><input type="radio" name="accion" value="Omision" id="omision" /> Omisión</label></div>
                <div></div>
                <div><input type="checkbox" name="guantes" class="checkbox" id="guantes" disabled> Guantes</div>
            </fieldset>

            <div align="center" style="margin-top: 20px;">
                <button type="reset" class="boton">Limpiar</button>
                <button type="submit" class="boton">Enviar</button>
            </div>
        </form>
    </div>
    <div class="result"></div>
    <footer style="max-width: 650px; align-items: center; margin: auto; font-size: 12px;"> <!-- FOOTER CON ESPECIFICACIONES DE NOMENCLATURAS  -->
        <table style="width: 100%; text-align: left;">
            <tr>
                <th colspan="2">Indicación</th>
                <th style="width: 46%">Acción de Higiene de manos</th>
            </tr>
            <tr>
                <td style="width:12%">Ant. pac.</td>
                <td>Antes del contacto con el paciente.</td>
                <td>FM - Fricción de manos con preparado a base de alcohol.</td>
            </tr>
            <tr>
                <td>Ant. asept.</td>
                <td>Antes de un procedimiento limpio / aséptico.</td>
                <td>LM - Lavado de manos con agua y jabón.</td>
            </tr>
            <tr>
                <td>Desp. ent. p.</td>
                <td>Después de contacto con entorno del paciente.</td>
            </tr>
            <tr>
                <td>Desp. pac.</td>
                <td>Después de contacto con paciente.</td>
            </tr>
            <tr>
                <td>Desp. fc.</td>
                <td>Después de riesgo a exposición de fluidos corporales.</td>
            </tr>
        </table>
    </footer>

    <script>
        document.getElementById('categoria').addEventListener('change', function(event){
            initTime = new Date();
        });
        document.getElementById('omision').addEventListener('change', function(event){
            document.getElementById('guantes').disabled = false;
        });
        document.getElementById('fm').addEventListener('change', function(event){
            document.getElementById('guantes').disabled = true;
            document.getElementById('guantes').checked = false;
        });
        document.getElementById('lm').addEventListener('change', function(event){
            document.getElementById('guantes').disabled = true;
            document.getElementById('guantes').checked = false;
        });

        document.getElementById('dataForm').addEventListener('submit', function(event) {
            event.preventDefault();

            if (typeof initTime === 'undefined'){
                alert('Cambie Categoría a otro valor y regrese al valor original.');
                return;
            }

            if (!(document.getElementById('nombre').value).includes(" ")) {
                alert('Ingrese su Nombre Completo.');
                return;
            }
            if (document.getElementById('matricula').value.length != 8){
                alert('Ingrese una Matricula correcta: 8 dígitos.');
                return;
            }
            
            endTime = new Date();
            var time = endTime - initTime;
            var minutes = Math.floor(time/(1000*60)).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false});
            var seconds = Math.floor(time/1000).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false});
            var mseconds = time - (seconds*1000);
            var duracion = minutes + ":" + seconds + "." + mseconds;
            
            const formData = {
                turno: document.getElementById('turno').value,
                servicio: document.getElementById('servicio').value,
                nombre: document.getElementById('nombre').value,
                matricula: document.getElementById('matricula').value,
                categoria: document.getElementById('categoria').value,
                indicacion: document.querySelector("input[name=indicacion]:checked").value,
                accion: document.querySelector("input[name=accion]:checked").value,
                guantes: document.getElementById('guantes').checked,
                time: duracion
            };
            //console.log(time, duracion);

            fetch('https://script.google.com/macros/s/AKfycbyjjW3llHVvHwhWRYmxTAILmo87NFHEQLr_W8U4i0wfUTfemKf2l1XH67-jM1BZoXrI/exec', { // Replace with your Web App URL
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                mode: 'same-origin',
                body: JSON.stringify(formData)
            })
            .then(response => response.text())
            .then(data => {
                alert('Información registrada correctamente.');
                console.log('Exito:', formData);

                document.getElementById('categoria').value = '';
                document.getElementById('guantes').checked = false;
                document.querySelector("input[name=indicacion]:checked").checked = false;
                document.querySelector("input[name=accion]:checked").checked = false;
                
                console.log(JSON.stringify(data));
                //document.getElementById('result').innerHTML = `Received from Google Sheets: ${JSON.stringify(data)}`;
            })
            .catch((error) => {
                console.error('Error:', formData);
                alert('An error occurred while submitting the form.');
            });
        });
    </script>
</body>
</html>
